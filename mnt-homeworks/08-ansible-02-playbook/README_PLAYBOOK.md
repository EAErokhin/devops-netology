# Установка ClickHouse и Vector

## Цели:
Этот плейбук предназначен для установки и настройки ClickHouse и Vector на целевых хостах.

## Целевые хосты: 
Хосты, на которых будет выполняться установка ClickHouse и Vector, должны быть определены в группе хостов clickhouse.

## Зависимости: 
Для успешного выполнения этого плейбука необходим доступ к Интернету, так как плейбук загружает пакеты ClickHouse и Vector из удаленных репозиториев.

## Задачи:

### 1. Start clickhouse service: 
Задача перезапуска службы ClickHouse после установки. Перед выполнением этой задачи необходимо убедиться, что ClickHouse установлен.
### 2. Restart Vector: 
Задача перезапуска службы Vector после установки. Перед выполнением этой задачи необходимо убедиться, что Vector установлен.
### 3. Block install clickhouse: 
Задача для установки ClickHouse. Внутри блока выполняются следующие действия:
 - Загрузка пакетов ClickHouse из удаленных репозиториев.
 - Обработка ошибок при загрузке, если один из пакетов недоступен.
### 4. Install clickhouse packages: 
Задача для установки пакетов ClickHouse, после чего происходит оповещение для перезапуска службы ClickHouse.
### 5. Flush handlers: 
Задача для сброса обработчиков. Это гарантирует, что обработчики, такие как "Start clickhouse service", будут выполнены после успешной установки ClickHouse.
### 6. Create database: 
Задача для создания базы данных "logs" в ClickHouse. Эта задача выполняется только в случае успешной установки ClickHouse.
### 7. Download Vector: 
Задача для загрузки пакета Vector из удаленного репозитория.
### 8. Install vector: 
Задача для установки пакета Vector.
### 9. Create Vector Configuration: 
Задача для создания конфигурационного файла Vector. Этот файл используется для настройки работы Vector.

## Теги:

### clickhouse: 
Используйте этот тег для выполнения задач, связанных с установкой и настройкой ClickHouse.
### vector: 
Используйте этот тег для выполнения задач, связанных с установкой и настройкой Vector.

### Примеры использования тегов:

Для выполнения только задач, связанных с ClickHouse, используйте команду:
```
ansible-playbook playbook.yml --tags clickhouse
```
Для выполнения только задач, связанных с Vector, используйте команду:
```
ansible-playbook playbook.yml --tags vector
```
